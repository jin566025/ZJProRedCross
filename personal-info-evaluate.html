<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
		<meta name="keywords" content=""/>
		<meta name="description" content=""/>
		<title>报名详情</title>
		<link rel="icon" href="icons/ico.ico" type="image/x-icon">
		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" href="css/detail.css" />
		<style>
			#table td{width: 100px;}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="main">
				<div class="header clearfix">
					<div class="logo fl">
						<img class="logo-img" src="icons/logo.png" />
						<a class="logo-name">浙江省红十字会</a>
					</div>
					<div class="login-register fr">
						<img class="personal-info" src="icons/person-info.png" />
						<div class="personal-info-nav">
							<p onclick="window.location.href='personal-info.html'">个人资料</p>
							<p onclick="window.location.href='personal-change-password.html'">修改密码</p>
							<p id="quit">退出</p>
						</div>
					</div>
				</div>
				<div class="nav-container clearfix">
					<div class="nav nav-active">培训报名</div>
					<div class="nav">网上学习</div>
					<div class="nav">培训大纲</div>
					<div class="nav">个人中心</div>
				</div>
				<div class="content clearfix">
					<p class="positions">
						<a>当前位置：</a>
						<a class="positions-a" onclick="history.go(-1)">培训报名></a>
						<a class="positions-a" onclick="history.go(-1)">培训计划详情></a>
						<a class="positions-a">评估</a>
					</p>
					<div class="content-left fl">
						<div class="content-left-nav content-left-nav-active">我的课程</div>
						<div class="content-left-nav" onclick="window.location.href='personal-score.html'">我的学分</div>
						<div class="content-left-nav" onclick="window.location.href='personal-test.html'">我的考试</div>
						<div class="content-left-nav" onclick="window.location.href='personal-result.html'">我的成绩</div>
						<div class="content-left-nav" onclick="window.location.href='check-table1.html'">成人心肺复苏实操考核表</div>
						<div class="content-left-nav" onclick="window.location.href='check-table2.html'">外出血救护实操考核表</div>
						<div class="content-left-nav" onclick="window.location.href='check-table3.html'">四肢骨折救护实操考核表</div>
					</div>
					<div class="content-right fr ">
						<div class="trainUnit"  data-unitid="0">
							<div class="eva-section1">
								<p class="eva-title">1.您对本次学习班的各项安排及服务是否满意</p>
								<div class="option-content clearfix">
									<div class="options clearfix" >
										<a class="options-text">满意</a>
										<a class="options-circle options-active"></a>
									</div>
									<div class="options clearfix" >
										<a class="options-text">比较满意</a>
										<a class="options-circle"></a>
									</div>
									<div class="options clearfix" >
										<a class="options-text">不满意</a>
										<a class="options-circle"></a>
									</div>
								</div>
							</div>
							
							<div class="eva-section1">
								<p class="eva-title">2.您对本次学习班的教学安排是否满意</p>
								<div class="option-content clearfix">
									<div class="options clearfix" >
										<a class="options-text">满意</a>
										<a class="options-circle"></a>
									</div>
									<div class="options clearfix" >
										<a class="options-text">比较满意</a>
										<a class="options-circle"></a>
									</div>
									<div class="options clearfix" >
										<a class="options-text">不满意</a>
										<a class="options-circle"></a>
									</div>
								</div>
							</div>
							
							<div class="eva-section1">
								<p class="eva-title">3.您对本次培训班的课件是否满意</p>
								<div class="option-content clearfix">
									<div class="options clearfix" >
										<a class="options-text">满意</a>
										<a class="options-circle"></a>
									</div>
									<div class="options clearfix" >
										<a class="options-text">比较满意</a>
										<a class="options-circle"></a>
									</div>
									<div class="options clearfix" >
										<a class="options-text">不满意</a>
										<a class="options-circle"></a>
									</div>
								</div>
							</div>
						</div>
						<div class="eva-section1">
							<p class="eva-title">4.请您对各位授课教师的授课情况给予评价</p>
							<div class="table-border">
							<table id="tablee" class="table" border="1" bordercolor="#bbbbbb" style="border-collapse:collapse;">
								<tr>
									<td rowspan="2">授课内容</td>
									<td colspan="3">准备程度</td>
									<td colspan="3">内容准确性</td>
									<td colspan="3">讲课清晰度</td>
								</tr>
								<tr>
									<td>满意</td>
									<td>较满意</td>
									<td>不满意</td>
									<td>满意</td>
									<td>较满意</td>
									<td>不满意</td>
									<td>满意</td>
									<td>较满意</td>
									<td>不满意</td>
								</tr>
							</table>
							
						</div>
						<div class="eva-section1">
							<p class="eva-title">5.意见与建议</p>
							<textarea class="eva-textarea" placeholder="请留下你宝贵的意见或建议……"></textarea>
						</div>
						
						<div class="submit" id="submit">提交</div>
					</div>
					
				</div>
				
				
			</div>
		</div>
		<script type="text/javascript" src="js/jquery-3.0.0.js" ></script>
		<script type="text/javascript" src="js/href.js" ></script>
		<script type="text/javascript" src="js/url.js" ></script>
		<script type="text/javascript" src="js/checkUser.js" ></script>
		<script type="text/javascript" src="js/url.js" ></script>
		<script>
			$(function(){
				var planId = parseInt(window.location.href.split("=")[1]);
				$(".main").on("click",".options-circle",function(){
					var brother = $(this).parent().parent().find(".options-circle");
					brother.removeClass("options-active");
					$(this).addClass("options-active");
				})
				
				$.ajax({
					type:"post",
					url:url_path+"/plan/getTrainingUnitList.json",
					data:{
						"planId":planId
					},
					dataType:"json",
					success:function(data){
						if(data.msg=="成功"){
							var list = data.unitList;
							for(var i=0;i<list.length;i++){
								var html = '<tr class="trainUnit"  data-unitid='+list[i].trainUnitId+'>'+
												'<td>'+list[i].unitName+'</td>'+
												'<td colspan="3" class="clearfix">'+
													'<div class="options-circle2"><a class="options-circle"></a></div><div class="options-circle2 options-circle-mid"><a class="options-circle"></a></div><div class="options-circle2"><a class="options-circle"></a></div>'+
												'</td>'+
												'<td colspan="3" class="clearfix">'+
													'<div class="options-circle2"><a class="options-circle"></a></div><div class="options-circle2 options-circle-mid"><a class="options-circle"></a></div><div class="options-circle2"><a class="options-circle"></a></div>'+
												'</td>'+
												'<td colspan="3" class="clearfix">'+
													'<div class="options-circle2"><a class="options-circle"></a></div><div class="options-circle2 options-circle-mid"><a class="options-circle"></a></div><div class="options-circle2"><a class="options-circle"></a></div>'+
												'</td>'+
											'</tr>';
								$("#tablee").append(html)
							}
						}
					},
					error:function(){}
				});
				$("#submit").click(function(){

					var advise = $(".eva-textarea").val();
					var content = [];
					var trainUnit = $(".trainUnit");
					for(var i=0;i<trainUnit.length;i++){
						content[i] = {};
						content[i].unitid = $(trainUnit[i]).attr("data-unitid");
						var option_active = $(trainUnit[i]).find(".options-active");
						var active_array = [];
						for(var j=0;j<option_active.length;j++){
							var active_index = $(option_active[j]).parent().index()+1;
							active_array.push(active_index);
						}
						var active_str = active_array.join(",");
						content[i].option = active_str;
					}
					var saveDataArray = {};
					saveDataArray.planId = planId;
					saveDataArray.redUserId=redUserId;
					if(advise){
						saveDataArray.advise=advise;
					}else{
						alert("请填写意见与建议");
						return false;
					}
					if(content){
						saveDataArray.content=content;
					}else{
						alert("请选择完整");
						return false;
					}

					console.log(saveDataArray)
					$.ajax({
						type:"post",
						url:url_path+"/plan/savePlanEvaluation.json",
						data:saveDataArray,
						dataType:"json",
						success:function(data){
							console.log(data)
						},
						error:function(){}
					});
				})
			})
		</script>
	</body>
</html>
