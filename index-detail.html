<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
		<meta name="keywords" content=""/>
		<meta name="description" content=""/>
		<title>报名详情</title>
		<link rel="icon" href="icons/ico.ico" type="image/x-icon">
		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" href="css/detail.css" />

	</head>
	<body>
		<div class="container">
			<div class="main">
				<div class="header clearfix">
					<div class="logo fl">
						<img class="logo-img" src="icons/logo.png" />
						<a class="logo-name">浙江省红十字会</a>
					</div>
					<div class="login-register fr">
						<img class="personal-info" src="icons/person-info.png" />
						<div class="personal-info-nav">
							<p onclick="window.location.href='personal-info.html'">个人资料</p>
							<p onclick="window.location.href='personal-change-password.html'">修改密码</p>
							<p id="quit">退出</p>
						</div>
					</div>
				</div>
				<div class="nav-container clearfix">
					<div class="nav nav-active">培训报名</div>
					<div class="nav">网上学习</div>
					<div class="nav">培训大纲</div>
					<div class="nav">个人中心</div>
				</div>
				<div class="content clearfix">
					<p class="positions">
						<a>当前位置：</a>
						<a class="positions-a" onclick="goBack()">培训报名></a>
						<a>报名详情</a>
					</p>
					<div class="content-left fl">
						<div class="content-left-nav content-left-nav-active">全部</div>
						<div class="content-left-nav" data-typeid="1">专题培训(讲座)</div>
						<div class="content-left-nav" data-typeid="2">救护员初训</div>
						<div class="content-left-nav" data-typeid="3">救护员复训</div>
						<div class="content-left-nav" data-typeid="4">二级救护师初训</div>
						<div class="content-left-nav" data-typeid="5">二级救护师复训</div>
						<div class="content-left-nav" data-typeid="6">三级救护师初训</div>
						<div class="content-left-nav" data-typeid="7">三级救护师复训</div>
						<div class="content-left-nav" data-typeid="8">骨干班</div>
						<div class="content-left-nav" data-typeid="9">AHA培训</div>
					</div>
					<div class="content-right fr">
						<div class="detail-main">
							<div class="detail-content clearfix">
								<div class="detail-head fr">
									<p class="detail-head-p">
										<a>【</a>
										<a>宁波市</a>
										<a>】</a>
										<a id="class_name"></a>
									</p>
									<div class="detail-head-section clearfix">
										<div class="detail-head-section-part fl">
											<a>课程类型：</a>
											<a id="class_type"></a>
										</div>
										<div class="detail-head-section-part fl">
											<a>报名人数：</a>
											<a id="Singup"></a>
										</div>
										
									</div>
									<div class="detail-head-section clearfix">
										<div class="detail-head-section-part fl">
											<a>报名时间：</a>
											<a id="class_time"></a>
										</div>
										<div class="detail-head-section-part fl">
											<a>培训地点：</a>
											<a id="class_address"></a>
										</div>
										
									</div>
									<div class="detail-head-section clearfix">
										<div class="detail-head-section-part fl">
											<a>培训班编号：</a>
											<a>暂无</a>
										</div>
										<div class="detail-head-section-part fl">
											<a>培训班期数：</a>
											<a>暂无</a>
										</div>
										<div class="detail-head-section-part detail-head-section-part2 fr">
											报名
										</div>
									</div>
									
								</div>
								
							</div>
							<div class="detail-desc">
								<p>
									<a>班主任：</a>
									<a id="class_teacher"></a>
								</p>
								<p>培训计划介绍：</p>
								<p id="introduce">暂无</p>
							</div>
						</div>
						<div id="table">
						<table class="detail-table" border="1" bordercolor="#bbbbbb" style="border-collapse:collapse;" id="table1">
							<tr>
								<td colspan="8">课程表</td>
							</tr>
							<tr>
								<td colspan="3">时间</td>
								<td colspan="2">内容</td>
								<td>地点</td>
								<td>主讲</td>
								<td>辅讲</td>
							</tr>
						</table>
						<!--<table class="detail-table" border="1" bordercolor="#bbbbbb" style="border-collapse:collapse;" id="table2"></table>
						<table class="detail-table" border="1" bordercolor="#bbbbbb" style="border-collapse:collapse;" id="table3"></table>-->
						</div>
					</div>
					
				</div>
				
				
			</div>
		</div>
		<script type="text/javascript" src="js/jquery-3.0.0.js" ></script>
		<script type="text/javascript" src="js/href.js" ></script>
		<script type="text/javascript" src="js/url.js" ></script>
		<script>
			function goBack(){
				sessionStorage.removeItem("trainType2");
				history.go(-1)
			}
			$(function(){
				function timestampToTime(timestamp) {
			        var date = new Date(timestamp);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
			        Y = date.getFullYear() + '-';
			        M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
			        D = date.getDate() + ' ';
			        h = date.getHours();
			        m = date.getMinutes();
			        if(h<10){
			        	h = '0'+h
			        }
			        if(m<10){
			        	m = '0'+m
			        }
			        return h +':'+m;
			    }
				$(".content-left-nav").click(function(){
					var trainType2 = $(this).data("typeid");
					if(trainType2){
						sessionStorage.setItem("trainType2",trainType2)
					}else{
						sessionStorage.setItem("trainType2",0)
					}
					window.location.href = "index.html"
				})
				
				var classarray = JSON.parse(sessionStorage.getItem("classarray"));
				var classid = classarray.classid;
				var class_name = classarray.class_name;
				var class_type = classarray.class_type;
				var Singup = classarray.Singup;
				var class_time = classarray.class_time;
				var class_address = classarray.class_address;
				var class_teacher = classarray.class_teacher;
				var type_id = classarray.type_id;
				$("#class_name").html(class_name);
				$("#class_type").html(class_type);
				$("#Singup").html(Singup);
				$("#class_time").html(class_time);
				$("#class_address").html(class_address);
				$("#class_teacher").html(class_teacher);
				
				
				
				$(".detail-main").click(function(){
					if(type_id==2){
						window.location.href ="enroll2.html?classid="+classid;
					}else if(type_id==3){
						window.location.href ="enroll3.html?classid="+classid;
					}else{
						window.location.href="enroll.html?classid="+classid;
					}
					
				})
				
				
				
				var Singup1 = parseInt(Singup.split("/")[0])
				var Singup2 = parseInt(Singup.split("/")[1])
				if(Singup1==Singup2){
					$(".detail-head-section-part2").remove();
				}
				$.ajax({
					type:"post",
					url:url_path+"/plan/getTrainPlanDetail.json",
					data:{
						"planId":classid,
						"redUserId":redUserId
					},
					dataType:"json",
					success:function(data){
						console.log(data)
						
						if(data.msg=="成功"){
							$("#introduce").html(data.introduce);
							var planDayList = data.planDayList;
							var signupState = data.signupState;
							if(signupState==1 || signupState==0){
								$(".detail-head-section-part2").remove();
							}
							for(var i=0;i<planDayList.length;i++){
								var dayCourseList = planDayList[i].dayCourseList;
								var dates = planDayList[i].date;
								var length = dayCourseList.length;
								var html = "";
								var html2 = "";
								var am_pm = "";
								
								for(var j=0;j<dayCourseList.length;j++){
									var start = timestampToTime(dayCourseList[j].start);
									var end = timestampToTime(dayCourseList[j].end);
									var content = dayCourseList[j].content;
									if(!content){
										content = "无"
									}
									var address = dayCourseList[j].address;
									if(!address){
										address = "无"
									}
									var lecturer = dayCourseList[j].lecturer;
									if(!lecturer){
										lecturer = "无"
									}
									var assistant = dayCourseList[j].assistant;
									if(!assistant){
										assistant = "无"
									}
									if(j==0){
										html2 = '<td rowspan="'+length+'">'+dates+'</td>';
									}else{
										html2 = '';
									}
									
									var end2 = parseInt(end.split(":")[0]);
									if(end2<=12){
										am_pm = "上午" 
									}else{
										am_pm = "下午"
									}
									html += '<tr>'+html2+
												'<td>'+am_pm+'</td>'+
												'<td>'+start+'-'+end+'</td>'+
												'<td colspan="2">'+content+'</td>'+
												'<td>'+address+'</td>'+
												'<td>'+lecturer+'</td>'+
												'<td>'+assistant+'</td>'+
											'</tr>';
								}
								$("#table1").append(html)
							}
						}
					}
				});
			})
		</script>
		<script type="text/javascript" src="js/checkUser.js" ></script>
	</body>
</html>
