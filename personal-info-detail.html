<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
		<meta name="keywords" content=""/>
		<meta name="description" content=""/>
		<title>报名详情</title>
		<link rel="icon" href="icons/ico.ico" type="image/x-icon">
		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" href="css/detail.css" />
		<style>
			#table td{width: 100px;}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="main">
				<div class="header clearfix">
					<div class="logo fl">
						<img class="logo-img" src="icons/logo.png" />
						<a class="logo-name">浙江省红十字会</a>
					</div>
					<div class="login-register fr">
						<img class="personal-info" src="icons/person-info.png" />
						<div class="personal-info-nav">
							<p onclick="window.location.href='personal-info.html'">个人资料</p>
							<p onclick="window.location.href='personal-change-password.html'">修改密码</p>
							<p id="quit">退出</p>
						</div>
					</div>
				</div>
				<div class="nav-container clearfix">
					<div class="nav nav-active">培训报名</div>
					<div class="nav">网上学习</div>
					<div class="nav">培训大纲</div>
					<div class="nav">个人中心</div>
				</div>
				<div class="content clearfix">
					<p class="positions">
						<a>当前位置：</a>
						<a class="positions-a" onclick="history.go(-1)">培训报名></a>
						<a>培训计划详情</a>
					</p>
					<div class="content-left fl">
						<div class="content-left-nav content-left-nav-active">我的课程</div>
						<div class="content-left-nav" onclick="window.location.href='personal-score.html'">我的学分</div>
						<div class="content-left-nav" onclick="window.location.href='personal-test.html'">我的考试</div>
						<div class="content-left-nav" onclick="window.location.href='personal-result.html'">我的成绩</div>
						<div class="content-left-nav" onclick="window.location.href='check-table1.html'">成人心肺复苏实操考核表</div>
						<div class="content-left-nav" onclick="window.location.href='check-table2.html'">外出血救护实操考核表</div>
						<div class="content-left-nav" onclick="window.location.href='check-table3.html'">四肢骨折救护实操考核表</div>
					</div>
					<div class="content-right fr">
						<div class="detail-main">
							<div class="detail-content clearfix">
								<div class="detail-head fr">
									<p class="detail-head-p">
										<a>【</a>
										<a>宁波市</a>
										<a>】</a>
										<a id="class_name"></a>
									</p>
									<div class="detail-head-section clearfix">
										<div class="detail-head-section-part fl">
											<a>课程类型：</a>
											<a id="class_type"></a>
										</div>
										<div class="detail-head-section-part fl">
											<a>报名人数：</a>
											<a id="Singup"></a>
										</div>
										
									</div>
									<div class="detail-head-section clearfix">
										<div class="detail-head-section-part fl">
											<a>报名时间：</a>
											<a id="class_time"></a>
										</div>
										<div class="detail-head-section-part fl">
											<a>培训地点：</a>
											<a id="class_address"></a>
										</div>
										
									</div>
									<div class="detail-head-section clearfix">
										
										<div class="detail-head-section-part detail-head-section-part2 fr">
											评估
										</div>
									</div>
									
								</div>
								
							</div>
							<div class="detail-desc">
								<p>
									<a>班主任：</a>
									<a id="class_teacher"></a>
								</p>
								<p>培训计划介绍：</p>
								<p id="introduce">暂无</p>
							</div>
						</div>
						<div id="table">
						<table class="detail-table" border="1" bordercolor="#bbbbbb" style="border-collapse:collapse;" id="table1">
							<tr>
								<td colspan="9">课程表</td>
							</tr>
							<tr>
								<td colspan="3">时间</td>
								<td colspan="2">内容</td>
								<td>地点</td>
								<td>主讲</td>
								<td>辅讲</td>
								<td>签到</td>
							</tr>
						</table>
						<!--<table class="detail-table" border="1" bordercolor="#bbbbbb" style="border-collapse:collapse;" id="table2"></table>
						<table class="detail-table" border="1" bordercolor="#bbbbbb" style="border-collapse:collapse;" id="table3"></table>-->
						</div>
					</div>
					
				</div>
				
				
			</div>
		</div>
		<script type="text/javascript" src="js/jquery-3.0.0.js" ></script>
		<script type="text/javascript" src="js/href.js" ></script>
		<script type="text/javascript" src="js/url.js" ></script>
		<script type="text/javascript" src="js/checkUser.js" ></script>
		<script>
			$(function(){
				function timestampToTime(timestamp) {
			        var date = new Date(timestamp);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
			        Y = date.getFullYear() + '-';
			        M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
			        D = date.getDate() + ' ';
			        h = date.getHours();
			        m = date.getMinutes();
			        if(h<10){
			        	h = '0'+h
			        }
			        if(m<10){
			        	m = '0'+m
			        }
			        return h +':'+m;
			    }
				var classarray = JSON.parse(sessionStorage.getItem("classarray2"));
				var classid = classarray.classid;
				var class_name = classarray.class_name;
				var class_type = classarray.class_type;
				var Singup = classarray.Singup;
				var class_time = classarray.class_time;
				var class_address = classarray.class_address;
				var class_teacher = classarray.class_teacher;
				$("#class_name").html(class_name);
				$("#class_type").html(class_type);
				$("#Singup").html(Singup);
				$("#class_time").html(class_time);
				$("#class_address").html(class_address);
				$("#class_teacher").html(class_teacher);
				$(".detail-head-section-part2").click(function(){
					window.location.href="personal-info-evaluate.html?classid="+classid;
				})

				$.ajax({
					type:"post",
					url:url_path+"/plan/getTrainPlanDetail.json",
					data:{
						"planId":classid,
						"redUserId":redUserId
					},
					dataType:"json",
					success:function(data){
						console.log(data)
						
						if(data.msg=="成功"){
							$("#introduce").html(data.introduce);
							var planDayList = data.planDayList;
							for(var i=0;i<planDayList.length;i++){
								var dayCourseList = planDayList[i].dayCourseList;
								var dates = planDayList[i].date;
								var length = dayCourseList.length;
								var html = "";
								var html2 = "";
								var am_pm = "";
								for(var j=0;j<dayCourseList.length;j++){
									var start = timestampToTime(dayCourseList[j].start);
									var end = timestampToTime(dayCourseList[j].end);
									if(j==0){
										html2 = '<td rowspan="'+length+'">'+dates+'</td>';
									}else{
										html2 = '';
									}
									var end2 = parseInt(end.split(":")[0]);
									if(end2<=12){
										am_pm = "上午" 
									}else{
										am_pm = "下午"
									}
									var amSignin = dayCourseList[j].amSignin;
									if(amSignin){
										amSignin = "已签到"
									}else{
										amSignin = "未签到"
									}
									var pmSignin = dayCourseList[j].pmSignin;
									if(pmSignin){
										pmSignin = "已签到"
									}else{
										pmSignin = "未签到"
									}
									var Signin;
									if(am_pm=="上午"){
										Signin = amSignin
									}else{
										Signin = pmSignin
									}
									html += '<tr>'+html2+
												'<td>'+am_pm+'</td>'+
												'<td>'+start+'-'+end+'</td>'+
												'<td colspan="2">'+dayCourseList[j].content+'</td>'+
												'<td>'+dayCourseList[j].address+'</td>'+
												'<td>'+dayCourseList[j].lecturer[0]+'</td>'+
												'<td>'+dayCourseList[j].assistant[0]+'</td>'+
												'<td>'+Signin+'</td>'+
											'</tr>';
									
								}
								$("#table1").append(html)
							}
						}
					}
				});
			})
		</script>
		
	</body>
</html>
